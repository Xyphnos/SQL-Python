DROP DATABASE IF EXISTS dad;
CREATE DATABASE dad;
USE dad;

CREATE TABLE ItemType
(
  ITID INT NOT NULL,
  Attack INT,
  Defense INT,
  Money INT,
  Name VARCHAR(50) NOT NULL,
  Intellect INT,
  HP INT,
  Special INT,
  PRIMARY KEY (ITID)
);

CREATE TABLE EnemyType
(
  Name VARCHAR(50) NOT NULL,
  ETID INT NOT NULL,
  Attack INT NOT NULL,
  Defense INT NOT NULL,
  HP INT NOT NULL,
  Intellect INT NOT NULL,
  PRIMARY KEY (ETID)
);

CREATE TABLE Magic
(
  MagicID INT NOT NULL,
  Name VARCHAR(50) NOT NULL,
  Effect INT NOT NULL,
  PRIMARY KEY (MagicID)
);

CREATE TABLE EnvT
(
  EnvTID INT NOT NULL,
  Name VARCHAR(50) NOT NULL,
  Attribute INT NOT NULL,
  PRIMARY KEY (EnvTID)
);

CREATE TABLE EnemyMagic
(
  MagicID INT NOT NULL,
  ETID INT NOT NULL,
  FOREIGN KEY (MagicID) REFERENCES Magic(MagicID),
  FOREIGN KEY (ETID) REFERENCES EnemyType(ETID)
);

CREATE TABLE NPCType
(
  Name VARCHAR(50) NOT NULL,
  NPCTID INT NOT NULL,
  Attack INT NOT NULL,
  Intellect INT NOT NULL,
  Defense INT NOT NULL,
  HP INT NOT NULL,
  PRIMARY KEY (NPCTID)
);

CREATE TABLE Environment
(
  XCo INT NOT NULL,
  YCo INT NOT NULL,
  EnvTID INT NOT NULL,
  PRIMARY KEY (XCo, YCo),
  FOREIGN KEY (EnvTID) REFERENCES EnvT(EnvTID)
);

CREATE TABLE NPC
(
  SHP INT NOT NULL,
  NPCID INT NOT NULL,
  NPCTID INT NOT NULL,
  XCo INT NOT NULL,
  YCo INT NOT NULL,
  PRIMARY KEY (NPCID),
  FOREIGN KEY (NPCTID) REFERENCES NPCType(NPCTID),
  FOREIGN KEY (XCo, YCo) REFERENCES Environment(XCo, YCo)
);

CREATE TABLE Player
(
  Name VARCHAR(40) NOT NULL,
  PID INT NOT NULL,
  Money INT NOT NULL,
  XCo INT NOT NULL,
  YCo INT NOT NULL,
  PRIMARY KEY (PID),
  FOREIGN KEY (XCo, YCo) REFERENCES Environment(XCo, YCo)
);

CREATE TABLE Stats
(
  SID INT NOT NULL,
  HP INT NOT NULL,
  Attack INT NOT NULL,
  Charisma INT NOT NULL,
  Intellect INT NOT NULL,
  PID INT NOT NULL,
  PRIMARY KEY (SID),
  FOREIGN KEY (PID) REFERENCES Player(PID)
);

CREATE TABLE Item
(
  IID INT NOT NULL,
  ITID INT NOT NULL,
  PID INT,
  XCo INT,
  YCo INT,
  NPCID INT,
  FOREIGN KEY (ITID) REFERENCES ItemType(ITID),
  FOREIGN KEY (PID) REFERENCES Player(PID),
  FOREIGN KEY (XCo, YCo) REFERENCES Environment(XCo, YCo),
  FOREIGN KEY (NPCID) REFERENCES NPC(NPCID)
);

CREATE TABLE Enemy
(
  EID INT NOT NULL,
  SHP INT NOT NULL,
  ETID INT NOT NULL,
  XCo INT NOT NULL,
  YCo INT NOT NULL,
  PRIMARY KEY (EID),
  FOREIGN KEY (ETID) REFERENCES EnemyType(ETID),
  FOREIGN KEY (XCo, YCo) REFERENCES Environment(XCo, YCo)
);

CREATE TABLE PlayerMagic
(
  MagicID INT NOT NULL,
  PID INT NOT NULL,
  FOREIGN KEY (MagicID) REFERENCES Magic(MagicID),
  FOREIGN KEY (PID) REFERENCES Player(PID)
);
