DROP DATABASE IF EXISTS dad1;
CREATE DATABASE dad1;
USE dad1;

CREATE TABLE ItemType
(
  ITID INT NOT NULL,
  Attack INT,
  Defense INT,
  Money INT,
  Name VARCHAR(50) NOT NULL,
  Intellect INT,
  HP INT,
  Special INT,
  PRIMARY KEY (ITID)
);

CREATE TABLE EnemyType
(
  Name VARCHAR(50) NOT NULL,
  ETID INT NOT NULL,
  Attack INT NOT NULL,
  Defense INT NOT NULL,
  HP INT NOT NULL,
  Intellect INT NOT NULL,
  PRIMARY KEY (ETID)
);

CREATE TABLE Magic
(
  MagicID INT NOT NULL,
  Name VARCHAR(50) NOT NULL,
  Effect INT NOT NULL,
  PRIMARY KEY (MagicID)
);

CREATE TABLE EnemyMagic
(
  MagicID INT NOT NULL,
  ETID INT NOT NULL,
  FOREIGN KEY (MagicID) REFERENCES Magic(MagicID),
  FOREIGN KEY (ETID) REFERENCES EnemyType(ETID)
);

CREATE TABLE NPCType
(
  Name VARCHAR(50) NOT NULL,
  NPCTID INT NOT NULL,
  Attack INT NOT NULL,
  Intellect INT NOT NULL,
  Defense INT NOT NULL,
  HP INT NOT NULL,
  PRIMARY KEY (NPCTID)
);

CREATE TABLE Movement
(
MoID VARCHAR(10) NOT NULL,
Direction VARCHAR(40),
PRIMARY KEY (MoID)
);

CREATE TABLE Tile
(
  TileID INT NOT NULL,
  Name VARCHAR(30) NOT NULL,
  Description VARCHAR(1000) NOT NULL,
  PRIMARY KEY (TileID)
);

DROP TABLE IF EXISTS PASSAGE;
CREATE TABLE Passage
(
  PassID VARCHAR(10) NOT NULL,
  FromTile INT NOT NULL,
  ToTile INT NOT NULL,
  MoID VARCHAR(10) NOT NULL,
  Locked BOOLEAN,
  Locknote VARCHAR(10),
  PRIMARY KEY (PassID),
  FOREIGN KEY (FromTile) REFERENCES Tile(TileID),
  FOREIGN KEY (ToTile) REFERENCES Tile(TileID),
  FOREIGN KEY (MoID) REFERENCES Movement(MoID)
);

CREATE TABLE Player
(
  Name VARCHAR(40) NOT NULL,
  PID INT NOT NULL,
  Money INT NOT NULL,
  TileID INT NOT NULL,
  PRIMARY KEY (PID),
  FOREIGN KEY (TileID) REFERENCES Tile(TileID)
);

CREATE TABLE Stats
(
  SID INT NOT NULL,
  HP INT NOT NULL,
  Attack INT NOT NULL,
  Charisma INT NOT NULL,
  Intellect INT NOT NULL,
  PID INT NOT NULL,
  PRIMARY KEY (SID),
  FOREIGN KEY (PID) REFERENCES Player(PID)
);

CREATE TABLE Enemy
(
  EID INT NOT NULL,
  SHP INT NOT NULL,
  ETID INT NOT NULL,
  TileID INT NOT NULL,
  PRIMARY KEY (EID),
  FOREIGN KEY (ETID) REFERENCES EnemyType(ETID),
  FOREIGN KEY (TileID) REFERENCES Tile(TileID)
);

CREATE TABLE PlayerMagic
(
  MagicID INT NOT NULL,
  PID INT NOT NULL,
  FOREIGN KEY (MagicID) REFERENCES Magic(MagicID),
  FOREIGN KEY (PID) REFERENCES Player(PID)
);

CREATE TABLE NPC
(
  SHP INT NOT NULL,
  NPCID INT NOT NULL,
  NPCTID INT NOT NULL,
  TileID INT NOT NULL,
  PRIMARY KEY (NPCID),
  FOREIGN KEY (NPCTID) REFERENCES NPCType(NPCTID),
  FOREIGN KEY (TileID) REFERENCES Tile(TileID)
);

drop table if exists item;
CREATE TABLE Item
(
  IID INT NOT NULL,
  ITID INT NOT NULL,
  PID INT,
  NPCID INT,
  TileID INT,
  Description VARCHAR(100) NOT NULL,
  FOREIGN KEY (ITID) REFERENCES ItemType(ITID),
  FOREIGN KEY (PID) REFERENCES Player(PID),
  FOREIGN KEY (NPCID) REFERENCES NPC(NPCID),
  FOREIGN KEY (TileID) REFERENCES Tile(TileID)
);
